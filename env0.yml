version: 1

deploy:
  steps:
    terraformApply:
      before:
        - |      
            pip3 install pyvmomi
            pip3 install cot
            chmod 755 ovftool.bundle
            ./ovftool.bundle
            wget https://env0-vsphere-test.s3.us-east-2.amazonaws.com/timtest.ovf
            wget https://env0-vsphere-test.s3.us-east-2.amazonaws.com/timtest.vmdk 
            cot deploy timtest.ovf esxi $HOST -u $USER -p $PASSWORD -n TimTest1
#            python3 deploy-ovf.py -s $HOST -o $PORT -u $USER -p $PASSWORD -f https://env0-vsphere-test.s3.us-east-2.amazonaws.com/timtest.ovf -v https://env0-vsphere-test.s3.us-east-2.amazonaws.com/timtest.vmdk
#            #python3 getallvms.py -s $HOST -o $PORT -u $USER -p $PASSWORD -S
            #python3 deploy-ovf.py -s $HOST -o $PORT -u $USER -p $PASSWORD -f timtest.ovf -v timtest.vmdk
destroy:
  steps:
    terraformDestroy:
      before:
        - |     
            pip3 install pyvmomi
            echo Remember to add destroy steps here when you get a successful deploy step....